$(function(){$(".doOrderBtn").click(function(e){return $(this).hasClass("inactive")?(e.preventDefault(),!1):!0}),$("#sale_agreement_accept").click(function(){$(this).is(":checked")?$(".doOrderBtn").removeClass("inactive"):$(".doOrderBtn").addClass("inactive")});var e=$("#order_basket");e.on("init",function(){$(".quantity",this).Quantity()}),window.qtyTimer=null,e.on("change",".quantity",function(){var t=$(this);$(this).next(".quantity-container");clearTimeout(window.qtyTimer),window.qtyTimer=setTimeout(function(){var a=t.data("id"),i=t.val();i.length&&i>0&&(t.attr("busy","y"),$.post("/basket/ajax/",{basket_id:a,quantity:i,action:"update"},function(a){if(t.attr("busy","n"),1==a.success)e.load("/basket/",{basket_refresh:"yes"},function(){e.trigger("init")}),$("#cart").load("/basket/ajax/small.php");else{var i=a.error||"Ошибка. Не удалось обновить корзину";alert(i)}},"json"))},500)}),e.on("click",".close-item",function(t){t.preventDefault();var a=$(this).data("id"),i=$(this).closest(".cartItem");return $.get("/basket/ajax/",{action:"delete",basket_id:a},function(){$("#cart").load("/basket/ajax/small.php"),i.slideUp(150,function(){i.remove(),$(".cartItem",e).size()<=0&&document.location.reload()}),e.load("/basket/",{basket_refresh:"yes"},function(){e.trigger("init")})},"json"),!1}),e.trigger("init"),$("body").on("popup_init",function(e,t){$("input[name=form_text_1]",t).mask("+7(999) 999-99-99"),$(".form-row.required .inputtext",t).addClass("required")})});
