function pluralStr(t,e,i,n){function a(t){return t%10==1&&t%100!=11?0:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?1:2}switch(a(t)){case 0:return e;case 1:return i;default:return n}}$(function(){var t;$(document).on("keyup",".input-basket-count",function(){var e=$(this),i=e.data("product"),n=e.parents(".rollover");"undefined"!=typeof t&&clearTimeout(t),t=setTimeout(function(){var t=e.val();0==parseInt(t)?$('.removeProduct[data-product="'+i+'"]').click():$.get(e.data("href")+"&quantity="+t,{},function(e){if($("#cart").load("/basket/ajax/small.php"),e.success&&n.length>0){var i=$("<div class='addNote arrow_box'>В корзине "+t+" "+pluralStr(t,"товар","товара","товаров")+"</div>");n.append(i),setTimeout(function(){i.fadeOut(function(){$(this).remove()})},1e3)}},"json")},200)}),$(document).on("click",".removeProduct",function(){var t=$(this),e=t.data("product"),i=t.parents(".rollover");$.get(t.data("href"),{},function(t){$("#cart").load("/basket/ajax/small.php"),t.success&&(i.removeClass("active"),$('.input-basket-count[data-product="'+e+'"]').val("0"))},"json")}),$(document).on("page.basket.update",function(){$.ajax({url:"/basket/ajax/",dataType:"json",type:"post",data:{action:"list"},success:function(t){if(t.success)for(var e in t.items)$input=$('.input-basket-count[data-product="'+e+'"]'),$rollover=$input.parents(".rollover"),$rollover.addClass("active"),$input.val(t.items[e].QUANTITY)}})}),$(document).trigger("page.basket.update"),$("body").on("click",".basket-add",function(t){t.preventDefault();var e=$(this),i=$(this).parents(".rollover"),n=$(this).data("picture");if(n){var a=$("#"+n),s=a.clone(),o=$(".main-nav .cart").offset();s.appendTo("body").addClass("animated-img").css({left:t.clientX,top:t.clientY+$(window).scrollTop()});var r=new TimelineMax;r.to(s,.5,{scale:1,alpha:1}).to(s,1,{top:o.top,left:o.left}).to(s,1,{scale:0,alpha:0,delay:-.5,onComplete:function(){s.remove()}})}return $.get(this.href,{},function(t){$("#cart").load("/basket/ajax/small.php"),t.success&&(i.addClass("active"),$(".input-basket-count",i).val("1"),$(".input-basket-count",i)[0].select(),"y"==e.attr("text_inside")&&e.text(newText))},"json"),!1})});
