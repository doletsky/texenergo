function forumActionComment(e,t){function a(e,t){if(!BX.type.isDomNode(e)||!BX.type.isDomNode(t))return!1;for(;e.childNodes.length>0;)t.appendChild(e.childNodes[0]);return!0}if(!BX.util.in_array(t,["DEL","MODERATE"]))return!1;if("DEL"==t&&!confirm(oText.cdm))return!1;var o=e.getAttribute("href");o=o.replace(/.AJAX_CALL=Y/g,"").replace(/.sessid=[^&]*/g,""),o+=(o.indexOf("?")>-1?"&":"?")+"AJAX_CALL=Y&sessid="+phpVars.bitrix_sessid,(linkParent=BX.findParent(e,{className:"forum-action-links"}))&&BX.hide(linkParent);var r=BX.create("a",{attrs:{className:"forum-action-note"}});r.innerHTML=oText.wait,linkParent.parentNode.appendChild(r);var i=function(e){BX.remove(r),BX.show(e)};return BX.ajax.loadJSON(o,function(n){if(1==n.status){var s=BX.findParent(e,{tag:"table"});if(s){var l=BX.findChild(s,{className:"forum-action-links"},!0);if("DEL"==t){var c=BX.findChild(s,{tagName:"tfoot"});if(c)for(lastMessage=s.previousSibling;lastMessage&&1!=lastMessage.nodeType;)lastMessage=lastMessage.previousSibling;var d=BX.create("div",{style:{overflow:"hidden"}});s.parentNode.insertBefore(d,s),d.appendChild(s),c&&lastMessage&&lastMessage.appendChild(c),BX.fx.hide(d,"scroll",{time:.35,callback_complete:function(){BX.remove(d);var e=BX.findChild(document,{"class":"forum-post-table"},!0,!0);(!e||e.length<1)&&(window.location=oForum.topic_read_url),i(l)}})}else{var u=BX.hasClass(s,"forum-post-hidden"),f=u?oText.hide:oText.show,m=BX.findChild(s,{className:"forum-cell-post"},!0),d=BX.create("div");a(m,d),m.appendChild(d),BX.fx.hide(d,"fade",{time:.1,callback_complete:function(){BX.toggleClass(s,"forum-post-hidden"),e.innerHTML=f,o=o.replace(new RegExp("ACTION="+(u?"SHOW":"HIDE")),"ACTION="+(u?"HIDE":"SHOW")),e.setAttribute("href",o),BX.fx.show(d,"fade",{time:.1,callback_complete:function(){a(d,m),m.removeChild(d)}}),i(l)}})}}}else BX.addClass(r,"error"),r.innerHTML='<font class="errortext">'+n.message+"</font>"}),!1}function SelectPosts(e){if(__forum_messages_selected=!__forum_messages_selected,form=document.forms["MESSAGES_"+e],"object"!=typeof form||null==form)return!1;var t=form.getElementsByTagName("input");if(t&&"object"==typeof t)for(t.length&&"undefined"!=typeof t.length||(t=[t]),ii=0;ii<t.length;ii++)if("checkbox"==t[ii].type&&"message_id[]"==t[ii].name){t[ii].checked=__forum_messages_selected;var a=t[ii].parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;t[ii].checked?a.className+=" forum-post-selected":a.className=a.className.replace(/\s*forum-post-selected/gi,"")}}function Validate(e){if("object"!=typeof e||null==e)return!1;var t=[];if("messages"==e.type.value){var a=e.getElementsByTagName("input");if(a&&"object"==typeof a){a.length&&"undefined"!=typeof a.length||(a=[a]);var o=!0;for(ii=0;ii<a.length;ii++)if("checkbox"==a[ii].type&&"message_id[]"==a[ii].name&&a[ii].checked){o=!1;break}o&&t.push(oText.no_data)}}return""==e.ACTION.value&&t.push(oText.no_action),t.length>0?(alert(t.join("\n")),!1):"DEL_TOPIC"==e.ACTION.value?confirm(oText.cdt):"DEL"==e.ACTION.value?confirm(oText.cdms):!0}function fReplyForm(){window.oLHE&&setTimeout(function(){window.oLHE.SetFocus()},100)}var __forum_messages_selected=!1;BX(function(){if(BX.browser.IsIE()){var e=BX.findChildren(document,{className:"forum-post-table"},!0);if(!e)return;for(a in e)for(var t=e[a].getElementsByTagName("*"),a=t.length;a--;)t[a].scrollWidth>t[a].offsetWidth&&(t[a].style.paddingBottom="20px",t[a].style.overflowY="hidden")}});
