$(function(){function e(e){var t,i=[];return 0==$(".required",e).size()?!1:($("input,textarea",e).each(function(){if("hidden"!=$(this).attr("type")){$(this).attr("id")||$(this).attr("id","form_field_"+(1e5-Math.round(1e5*Math.random())));var e={name:this.name,id:$(this).attr("id"),display:$(this).data("title")||"",rules:($(this).hasClass("required")?"required":"")+($(this).data("rules")?"|"+$(this).data("rules"):"")};i.push(e)}}),t=new FormValidator(e.attr("id"),i,function(t){if($(".field-error",e).removeClass("field-error"),$(".field-error-message",e).remove(),t.length>0){$(t).each(function(){var t=$("#"+this.id);t.hasClass("nicefileinput")&&(t=t.closest(".NFI-wrapper")),t.addClass("field-error"),t.next(".field-error-message").remove(),e.data("messages")&&!t.data("inline")&&"checkbox"!=t.attr("type")&&"radio"!=t.attr("type")&&t.after('<div class="field-error-message">'+this.message+"</div>")});var i=$(".field-error:first").offset().top;$("body").animate({scrollTop:i-40},500)}return!0}),t.registerCallback("check_date",function(e){var t=e.split("."),i=new Date;return 3!=t.length?!1:(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),t[2]=parseInt(t[2]),t[0]>31||t[0]<1?!1:t[1]>12||t[1]<1?!1:t[2]>i.getFullYear()||t[2]<i.getFullYear()-100?!1:!0)}).setMessage("check_date","Введите дату в формате ДД.ММ.ГГГГ"),t)}$(document).on("submit",".form",function(t){if(!$(this).hasClass("form-ajax")){var i=$(this),n=e(i);return n&&!n._validateForm()?(t.preventDefault(),!1):void 0}}),$(document).on("submit",".form-ajax",function(t){var i=$(this),n=i.attr("action"),a=e(i);return t.preventDefault(),(!a||a._validateForm())&&(i.addClass("form-loading"),$(".form-submit",i).attr("disabled",!0),$.post(n,i.serialize(),function(e){var t=jQuery.Event("complete");if(i.trigger(t,[e]),t.isDefaultPrevented())return!0;var n=$("<div>"+e+"</div>");i.removeClass("form-loading"),$(".form-submit",i).attr("disabled",!1),$(".form-ajax",n).size()>0?i.html($(".form-ajax",n).contents()):i.html(e),i.trigger("init")})),!1})});
