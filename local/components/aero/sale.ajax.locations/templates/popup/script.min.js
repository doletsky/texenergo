$(function(){$(".address-row").each(function(){if(!$(this).hasClass("js-address-row")){$(this).addClass("js-address-row");var t=$(this),e=[],a=$(".location-suggest",t),i=$("#"+a.data("field"));a.autocomplete({serviceUrl:"/local/components/aero/sale.ajax.locations/search.php",paramName:"search",params:{group:a.data("group")},showNoSuggestionNotice:!1,noSuggestionNotice:"Город не найден",minChars:3,autoSelectFirst:!1,preventBadQueries:!1,transformResult:function(t){var e=$.parseJSON(t);return{suggestions:$.map(e,function(t){var e=t.REGION_NAME?" ("+t.REGION_NAME+")":"";return{value:t.NAME+e,data:t}})}},onSelect:function(a){i.val(a.data.ID),e=a.data.ZIP,$(".zip-suggest",t).autocomplete("dispose"),$(".zip-suggest",t).autocomplete({lookup:e,autoSelectFirst:!0}),e.length>0&&$(".zip-suggest",t).val(e[0]),$(this).trigger("location-selected")}}),a.on("keyup",function(t){13!=t.keyCode&&i.val(0)}),a.on("blur",function(){i.val()<=0&&a.val("")}),$(".zip-suggest",t).autocomplete({lookup:e,autoSelectFirst:!0})}})});
